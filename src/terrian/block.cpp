#include "block.h"


//copied from pbrt
u32 Left3Shift(u32 x) {
	if (x == (1 << 10)) --x;
	x = (x | (x << 16)) & 0b00000011000000000000000011111111;
	// x = ---- --98 ---- ---- ---- ---- 7654 3210
	x = (x | (x << 8)) & 0b00000011000000001111000000001111;
	// x = ---- --98 ---- ---- 7654 ---- ---- 3210
	x = (x | (x << 4)) & 0b00000011000011000011000011000011;
	// x = ---- --98 ---- 76-- --54 ---- 32-- --10
	x = (x | (x << 2)) & 0b00001001001001001001001001001001;
	// x = ---- 9--8 --7- -6-- 5--4 --3- -2-- 1--0
	return x;
}

u32 TerrianChunck::MortonCode(u32 x, u32 y, u32 z)
{
	vkmc_assert(x < 128 && y < 128 && z < 128);
	return (Left3Shift(z) << 2) | (Left3Shift(y) << 1) | Left3Shift(x);
}

